<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iOS 12 Compatibility Test - Home Dashboard</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            color: white;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .test-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .test-pass {
            color: #51cf66;
            border-color: rgba(81, 207, 102, 0.3);
        }
        
        .test-fail {
            color: #ff6b6b;
            border-color: rgba(255, 107, 107, 0.3);
        }
        
        .test-warning {
            color: #ffd43b;
            border-color: rgba(255, 212, 59, 0.3);
        }
        
        .back-button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .back-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <a href="index.html" class="back-button">← Back to Dashboard</a>
        
        <h1>iOS 12 Compatibility Test</h1>
        <p>This page tests various features to ensure compatibility with iOS 12.5.7</p>
        
        <div id="test-results"></div>
        
        <div class="test-item">
            <h3>Browser Information</h3>
            <div id="browser-info"></div>
        </div>
        
        <div class="test-item">
            <h3>JavaScript Features</h3>
            <div id="js-features"></div>
        </div>
        
        <div class="test-item">
            <h3>Web APIs</h3>
            <div id="web-apis"></div>
        </div>
        
        <div class="test-item">
            <h3>Google APIs Test</h3>
            <div id="google-apis"></div>
        </div>
    </div>

    <script src="ios12-compatibility.js"></script>
    <script src="config.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            runCompatibilityTests();
        });
        
        function runCompatibilityTests() {
            const results = [];
            
            // Browser Information
            const browserInfo = document.getElementById('browser-info');
            browserInfo.innerHTML = `
                <p><strong>User Agent:</strong> ${navigator.userAgent}</p>
                <p><strong>iOS Version:</strong> ${window.ios12Compatibility.version ? 
                    window.ios12Compatibility.version.major + '.' + 
                    window.ios12Compatibility.version.minor + '.' + 
                    window.ios12Compatibility.version.patch : 'Unknown'}</p>
                <p><strong>Is iOS 12:</strong> ${window.ios12Compatibility.isIOS12 ? 'Yes' : 'No'}</p>
            `;
            
            // JavaScript Features
            const jsFeatures = document.getElementById('js-features');
            const jsTests = [
                { name: 'Async/Await', test: () => typeof (async () => {})() === 'object' },
                { name: 'Arrow Functions', test: () => typeof (() => {}) === 'function' },
                { name: 'Template Literals', test: () => `test${'ing'}` === 'testing' },
                { name: 'Destructuring', test: () => { const {a} = {a: 1}; return a === 1; }() },
                { name: 'Spread Operator', test: () => [...[1,2,3]].length === 3 },
                { name: 'Promise.finally', test: () => Promise.prototype.finally !== undefined },
                { name: 'Array.flat', test: () => Array.prototype.flat !== undefined },
                { name: 'Object.fromEntries', test: () => Object.fromEntries !== undefined }
            ];
            
            let jsHtml = '';
            jsTests.forEach(test => {
                try {
                    const result = test.test();
                    jsHtml += `<p class="${result ? 'test-pass' : 'test-fail'}">${test.name}: ${result ? '✓' : '✗'}</p>`;
                } catch (e) {
                    jsHtml += `<p class="test-fail">${test.name}: ✗ (Error: ${e.message})</p>`;
                }
            });
            jsFeatures.innerHTML = jsHtml;
            
            // Web APIs
            const webApis = document.getElementById('web-apis');
            const apiTests = [
                { name: 'Fetch API', test: () => typeof fetch === 'function' },
                { name: 'URLSearchParams', test: () => typeof URLSearchParams === 'function' },
                { name: 'localStorage', test: () => typeof localStorage === 'object' },
                { name: 'sessionStorage', test: () => typeof sessionStorage === 'object' },
                { name: 'JSON', test: () => typeof JSON === 'object' },
                { name: 'XMLHttpRequest', test: () => typeof XMLHttpRequest === 'function' }
            ];
            
            let apiHtml = '';
            apiTests.forEach(test => {
                try {
                    const result = test.test();
                    apiHtml += `<p class="${result ? 'test-pass' : 'test-fail'}">${test.name}: ${result ? '✓' : '✗'}</p>`;
                } catch (e) {
                    apiHtml += `<p class="test-fail">${test.name}: ✗ (Error: ${e.message})</p>`;
                }
            });
            webApis.innerHTML = apiHtml;
            
            // Google APIs Test
            const googleApis = document.getElementById('google-apis');
            googleApis.innerHTML = '<p class="test-warning">Loading Google APIs...</p>';
            
            // Test Google APIs loading
            const script = document.createElement('script');
            script.src = 'https://apis.google.com/js/api.js';
            script.onload = function() {
                if (window.gapi) {
                    googleApis.innerHTML = '<p class="test-pass">Google APIs: ✓ Loaded successfully</p>';
                } else {
                    googleApis.innerHTML = '<p class="test-fail">Google APIs: ✗ Failed to load</p>';
                }
            };
            script.onerror = function() {
                googleApis.innerHTML = '<p class="test-fail">Google APIs: ✗ Failed to load (network error)</p>';
            };
            document.head.appendChild(script);
            
            // Test fetch with a simple request
            setTimeout(async function() {
                try {
                    const response = await fetch('https://httpbin.org/get');
                    if (response.ok) {
                        googleApis.innerHTML += '<p class="test-pass">Fetch Test: ✓ Network request successful</p>';
                    } else {
                        googleApis.innerHTML += '<p class="test-fail">Fetch Test: ✗ Network request failed</p>';
                    }
                } catch (e) {
                    googleApis.innerHTML += '<p class="test-fail">Fetch Test: ✗ Network request error: ' + e.message + '</p>';
                }
            }, 2000);
        }
    </script>
</body>
</html>
